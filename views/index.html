<html>

<head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles/index.css">

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <div id="content" class="container">
        <div class="row">
            <div class="col-md-4"></div>
            <div class="col-md-4">
                <div class="form-group">
                    <input type="text" id="tokenInputField" class="form-control"
                        placeholder="Game Token ex: c292fa67-8715-4afc-851b-71671e8ddd35">
                    <button id="joinGameBtn" class="btn btn-success btn-md btn-block">Join Game</button>
                </div>
                <div>
                    <button id="joinRandomGameBtn" class="btn btn-success btn-md btn-block">Join Random Game</button>
                </div>
                <div>
                    <button id="createGameBtn" class="btn btn-success btn-md btn-block">Create Game</button>
                </div>
            </div>
            <div class="col-md-4"></div>
        </div>

    </div>
</body>
<script>
    console.log('hello world');

    const joinRandGameBtn = document.getElementById('joinRandomGameBtn');
    const joinGameBtn = document.getElementById('joinGameBtn');
    const createGameBtn = document.getElementById('createGameBtn');

    const tokenInputField = document.getElementById('tokenInputField');

    // Redirect to game with token
    const getToken = () => {
        axios.get('http://localhost:4000/game/createGame').then(response => {
            console.log(response.data.gameToken);
            localStorage.setItem('gameToken', response.data.gameToken);
            window.location.replace(`http://localhost:4000/game/${response.data.gameToken}`);
        })
    }

    // Adding click event to button
    createGameBtn.addEventListener('click', event => {
        getToken();
    });

    // Adding click event to button
    joinGameBtn.addEventListener('click', (event) => {
        joinGame();
    })

    // Join random game button handler
    const joinRandomGame = () => {
        console.log('Joining random game');
    }

    // Join game button hanlder
    const joinGame = () => {
        console.log('Joining game with token');
        let gameToken = tokenInputField.value;

        axios.post('http://localhost:4000/game/join', {
            gameToken: gameToken
        }).then(response => {
            localStorage.setItem('gameToken', response.data.gameToken);
            window.location.replace(`http://localhost:4000/game/${response.data.gameToken}`);
        })
    }

    // Create game button hanlder
    const createGame = () => {
        console.log('Creating game');
    }

</script>
</html>
